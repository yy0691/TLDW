# TLDW 项目结构与框架详解（小白友好版）

如果你是开发新手，想基于 TLDW 进行二次开发，这篇指南会帮你理清项目的基本结构、核心框架和开发思路，让你快速上手。


## 一、项目整体框架

TLDW 是一个基于 **Next.js 15** 的全栈应用，简单来说就是：
- **前端**：用 React 19 构建用户界面，搭配 Tailwind CSS 做样式，shadcn/ui 提供基础组件
- **后端**：用 Next.js 的「路由处理器」实现 API 接口，无需单独部署服务器
- **数据存储**：用 Supabase（类似 Firebase 的后端即服务）存储数据和处理用户认证
- **AI 功能**：调用 Google Gemini 模型处理视频内容（生成摘要、提取亮点等）


## 二、核心文件与文件夹（必看）

先看项目根目录的关键文件和文件夹，理解它们的作用：

```
TLDW/
├── app/                  # 核心业务代码（页面+API）
├── components/           # 可复用的UI组件
├── lib/                  # 工具函数和核心逻辑
├── public/               # 图片等静态资源
├── supabase/             # 数据库配置
├── package.json          # 项目依赖清单
└── README.md             # 项目说明
```


### 1. `app/` 文件夹：业务核心

这是 Next.js 15 最有特色的部分，包含**页面**和**API接口**，是项目的「心脏」。

#### 页面部分
- `app/page.tsx`：首页（用户输入视频URL的地方）
- `app/analyze/[videoId]/page.tsx`：视频分析主页面（核心功能页）
- `app/my-videos/page.tsx`：用户保存的视频列表
- `app/all-notes/page.tsx`：所有笔记的汇总页面
- `app/settings/page.tsx`：用户设置页面

#### API接口部分
在 `app/api/` 下，所有文件都是后端接口，比如：
- `app/api/video-info/route.ts`：获取视频基本信息（标题、时长等）
- `app/api/transcript/route.ts`：获取视频字幕
- `app/api/generate-summary/route.ts`：调用AI生成视频摘要
- `app/api/notes/route.ts`：处理用户笔记的增删改查

**新手提示**：修改功能时，先确定是改页面（UI）还是改接口（数据处理），再对应到 `app/` 下的文件。


### 2. `components/` 文件夹：UI组件库

这里放所有可复用的界面元素，比如按钮、输入框、播放器等。

- `components/url-input.tsx`：首页的URL输入框组件
- `components/youtube-player.tsx`：YouTube视频播放器
- `components/notes-panel.tsx`：笔记编辑面板
- `components/ui/`：基础UI组件（按钮、卡片等，基于shadcn/ui）

**新手提示**：想改某个按钮样式或输入框行为，先到这里找对应的组件文件。


### 3. `lib/` 文件夹：工具与逻辑

这里是项目的「大脑」，包含各种工具函数和核心逻辑：

- `lib/gemini-client.ts`：调用Google Gemini AI模型的代码
- `lib/supabase/`：操作Supabase数据库的工具
- `lib/security-middleware.ts`：安全相关的代码（防攻击）
- `lib/utils.ts`：通用工具函数（比如解析视频URL、格式化时间等）

**新手提示**：如果需要新增一个处理视频ID的函数，就加在 `lib/utils.ts` 里；如果要改AI调用逻辑，就看 `lib/gemini-client.ts`。


### 4. `supabase/` 文件夹：数据库配置

- `supabase/migrations/`：数据库表结构的配置文件（比如用户表、视频分析表）
- 不需要手动建表，运行迁移脚本会自动创建


### 5. 其他关键文件

- `package.json`：记录项目依赖的第三方库（比如React、Next.js等），`npm install` 就是根据这个文件安装依赖
- `next.config.ts`：Next.js的配置文件（比如允许加载的图片域名）
- `middleware.ts`：全局中间件（处理用户登录状态、安全验证等）


## 三、核心技术栈解析

作为新手，不需要立刻掌握所有技术，但要知道它们的作用：

| 技术/工具       | 作用                          | 新手学习优先级 |
|-----------------|-------------------------------|----------------|
| Next.js 15      | 全栈框架（页面+API）          | 高             |
| React 19        | 构建UI的库                    | 高             |
| TypeScript      | 带类型的JavaScript（减少错误） | 中             |
| Tailwind CSS    | 快速写样式的工具              | 中             |
| Supabase        | 数据库+用户认证               | 中             |
| Google Gemini   | AI模型（生成摘要等）          | 低（先会调用即可） |

**学习建议**：先学 Next.js 和 React 的基础，知道如何修改页面和组件，再逐步了解其他工具。


## 四、二次开发入门步骤

以「新增一个按钮显示视频时长」为例，带你走一遍流程：

1. **找到页面文件**：视频分析页在 `app/analyze/[videoId]/page.tsx`
2. **获取视频时长数据**：时长数据在视频信息接口 `app/api/video-info/route.ts` 中，确保已返回
3. **修改UI组件**：在页面中添加一个显示时长的元素（用 `components/ui/` 里的组件）
4. **调整样式**：用 Tailwind 的类名（比如 `text-gray-600`）调整显示效果
5. **测试**：运行 `npm run dev` 查看效果，有问题看控制台报错


## 五、常见问题与资源

1. **本地运行项目**：
   ```bash
   # 安装依赖
   npm install
   # 启动开发服务器（访问 http://localhost:3000）
   npm run dev
   ```

2. **改了代码没生效？**：Next.js 会自动刷新，若没反应可按 `Ctrl+C` 停止后重新运行 `npm run dev`

3. **不懂的文件不要删**：特别是 `lib/`、`middleware.ts` 这些核心文件，删了可能导致整个项目报错

4. **学习资源**：
   - Next.js 官方文档：https://nextjs.org/docs
   - React 官方文档：https://react.dev/
   - Tailwind CSS 教程：https://tailwindcss.com/docs


从简单的UI修改开始尝试，慢慢熟悉各个文件的作用，二次开发会越来越顺手！如果遇到具体问题，可以查看项目里的 `README.md` 和 `CLAUDE.md`，里面有更多技术细节。